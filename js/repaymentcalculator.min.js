var moneyForm=wNumb({thousand:" ",decimal:",",decimals:0}),moneyFormD=wNumb({thousand:" ",decimal:",",decimals:2}),slideramount=document.getElementById("slideramount"),sliderterm=document.getElementById("sliderterm"),sliderAmountOptions={start:5e4,step:1e3,min:1e4,max:1e5},sliderTermOptions={start:24,step:2,min:12,max:52};slideramount&&sliderterm&&(noUiSlider.create(slideramount,{start:sliderAmountOptions.start,connect:[!0,!1],step:sliderAmountOptions.step,range:{min:sliderAmountOptions.min,max:sliderAmountOptions.max}}),noUiSlider.create(sliderterm,{start:sliderTermOptions.start,connect:[!0,!1],step:sliderTermOptions.step,range:{min:sliderTermOptions.min,max:sliderTermOptions.max}}),sliderterm.noUiSlider.on("update",function(){displayLoanInfo(!1)}),slideramount.noUiSlider.on("update",function(){displayLoanInfo(!1)}));var schedule="";function calculateRepayment(e,t){var n=e<24?328.5:182.5,o=e/2,i=n/o/100,r=Math.pow(1+i,o),a=t*r*i/(r-1);$("#monthly").html(a.toFixed(2));for(var m="",l=0,s=0,d=t,u=0,p=(new Date,new Date),y=0;y<o;y++){if(s+=a,u=a-(l=d*i),d=d+l-a,p.setTime(p.getTime()+12096e5),0==y)var c=p.getDate()+"."+(p.getMonth()+1)+"."+p.getFullYear();m+="<tr>",m+="<td>"+(y+1)+"</td>",m+="<td>"+formatPaymentDate(p)+"</td>",m+="<td>"+moneyFormD.to(a)+"</td>",m+="<td>"+moneyFormD.to(l)+"</td>",m+="<td>"+moneyFormD.to(u)+"</td>",m+="<td>"+moneyFormD.to(d)+"</td>",m+="</tr>"}return payload={amount:t,term:e,dpr:n/365,interest:l,fee:0,repayment:s,monthly_repayment:a,first_date:c,schedule:m},payload}function displayLoanInfo(e){var t=calculateRepayment(parseFloat(sliderterm.noUiSlider.get()),parseFloat(slideramount.noUiSlider.get()));$("#loanamount_text").val(moneyForm.to(t.amount)),$(".loan-amount-display").html(moneyForm.to(t.amount)),$("#loanterm_text").val(t.term),$(".loan-term-display").html(t.term),$(".loan-interest-display").html(moneyFormD.to(t.interest)),$(".loan-dpr-display").html(moneyFormD.to(t.dpr)),$(".loan-fee-display").html(moneyForm.to(t.fee)),$(".monthly-repayment-display").html(moneyForm.to(t.monthly_repayment)),$(".loan-repayment-display").html(moneyForm.to(t.repayment)),$(".loan-firstdate-display").html(t.first_date),e&&$("#schedule").html(t.schedule)}function formatPaymentDate(e){var t=e.getDate()<10?"0":"";return t+=e.getDate()+".",t+=e.getMonth()+1<10?"0":"",t+=e.getMonth()+1+".",t+=e.getFullYear()}function debounce(e,t){var n=void 0;return function(){var o=this,i=arguments;clearTimeout(n),n=setTimeout(function(){return e.apply(o,i)},t)}}$(function(){$("#schedule-modal").on("shown.bs.modal",function(){displayLoanInfo(!0)}),$(".slider-value-amount").on("focus",function(){$(this).select()}),$("#loanamount_text").on("keyup",debounce(function(){if(value=$(this).val(),value<sliderAmountOptions.min||value>sliderAmountOptions.max)return!1;slideramount.noUiSlider.set(value)},200)),$("#loanamount_text").on("change",function(){value=$(this).val(),value<sliderAmountOptions.min?slideramount.noUiSlider.set(sliderAmountOptions.min):value>sliderAmountOptions.max?slideramount.noUiSlider.set(sliderAmountOptions.max):slideramount.noUiSlider.set(value)}),$("#loanterm_text").on("keyup",debounce(function(){if(value=$(this).val(),value<sliderTermOptions.min||value>sliderTermOptions.max)return!1;sliderterm.noUiSlider.set(value)},200)),$("#loanterm_text").on("change",function(){value=$(this).val(),value<sliderTermOptions.min?sliderterm.noUiSlider.set(sliderTermOptions.min):value>sliderTermOptions.max?sliderterm.noUiSlider.set(sliderTermOptions.max):sliderterm.noUiSlider.set(value)})});